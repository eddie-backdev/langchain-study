syntax = "proto3";

package ai;

option java_multiple_files = true;
option java_package = "com.itplace.ai.grpc";

service AiService {
  rpc EmbedText(EmbedRequest) returns (EmbedResponse);
  rpc RecommendQuestion(QuestionRecommendRequest) returns (QuestionRecommendResponse);
  rpc RecommendBenefits(BenefitRecommendRequest) returns (BenefitRecommendResponse);
}

message Status {
  bool success = 1;
  string code = 2;
  string message = 3;
}

message EmbedRequest {
  repeated string texts = 1;
}

message EmbedVector {
  string id = 1;
  repeated float values = 2;
}

message EmbedResponse {
  Status status = 1;
  repeated EmbedVector vectors = 2;
}

message PartnerInfo {
  string partner_name = 1;
  string image_url = 2;
}

message QuestionRecommendRequest {
  string question = 1;
  double latitude = 2;
  double longitude = 3;
  repeated PartnerInfo partners = 4;
  int32 top_k = 5;
}

message QuestionHit {
  string question = 1;
  string category = 2;
  double score = 3;
}

message QuestionRecommendResponse {
  Status status = 1;
  string category = 2;
  string reason = 3;
  repeated PartnerInfo partners = 4;
  repeated QuestionHit hits = 5;
}

message BenefitCandidate {
  string partner_name = 1;
  string benefit_name = 2;
  string category = 3;
  string description = 4;
  string context = 5;
  double score = 6;
  uint64 benefit_id = 7;
  string image_url = 8;
}

message BenefitRecommendRequest {
  string user_summary = 1;
  repeated BenefitCandidate candidates = 2;
  int32 top_k = 3;
}

message BenefitRecommendation {
  int32 rank = 1;
  string partner_name = 2;
  string reason = 3;
  repeated uint64 benefit_ids = 4;
  string image_url = 5;
}

message BenefitRecommendResponse {
  Status status = 1;
  repeated BenefitRecommendation items = 2;
}
